<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Elsa Coin App</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0; padding: 0; box-sizing: border-box;
      font-family: 'Montserrat', sans-serif;
    }
    body {
      background-color: #000;
      color: #fff;
      overflow: hidden;
    }
    #splash {
      background: linear-gradient(to bottom, #000, gold);
      color: white;
      font-size: 2.5em;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      animation: fadeOut 1s ease-in-out 3s forwards;
    }
    @keyframes fadeOut {
      to {
        opacity: 0;
        visibility: hidden;
      }
    }
    #languageSelect {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    .btn {
      padding: 10px 20px;
      margin: 10px;
      background-color: gold;
      border: none;
      color: black;
      font-size: 1em;
      cursor: pointer;
      border-radius: 5px;
    }
    .page {
      display: none;
      padding: 20px;
      height: 100vh;
      overflow-y: auto;
      background-color: #0a0a0a;
    }
    #nav {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid gold;
    }
    #nav button {
      flex: 1;
      padding: 10px;
      background: transparent;
      color: gold;
      border: none;
      font-size: 1em;
    }
    input, select {
      padding: 10px;
      width: 100%;
      margin: 10px 0;
      border: 1px solid #555;
      border-radius: 5px;
      background: #222;
      color: gold;
    }
    .section {
      margin-bottom: 30px;
    }
    .chart-container {
      height: 70vh;
      background: #111;
      margin-bottom: 20px;
    }
    .success, .error {
      background: red;
      color: white;
      text-align: center;
      padding: 5px;
      margin-top: 10px;
      animation: fade 2s ease-in-out forwards;
    }
    @keyframes fade {
      0% {opacity: 1;}
      100% {opacity: 0;}
    }
    .verified-badge {
      color: gold;
      background: #222;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <div id="splash">‚ú® The Supreme: Elsa ‚ú®</div>
  <div id="languageSelect">
    <h2>Select Language</h2>
    <button class="btn" onclick="showAuth('en')">English</button>
    <button class="btn" onclick="showAuth('fr')">Fran√ßais</button>
  </div>

  <div id="authPage" class="page">
    <h2 id="authTitle">Login</h2>
    <input type="email" id="authEmail" placeholder="Email">
    <input type="password" id="authPassword" placeholder="Password">
    <button class="btn" onclick="login()">Login</button>
    <button class="btn" onclick="register()">Register</button>
    <div id="authMessage"></div>
  </div>

  <div id="homePage" class="page">
    <h2>üìà Elsa Coin Chart</h2>
    <div class="chart-container" id="chartArea">[CANDLE CHART]</div>
    <input type="number" id="buyAmount" placeholder="Enter amount ($2 min)">
    <button class="btn" onclick="buyElsa()">Buy Elsa</button>
    <button class="btn" onclick="resellElsa()">Resell Elsa</button>
    <div id="buyMsg"></div>
  </div>

  <div id="userPage" class="page">
    <h2>üë§ Your Profile</h2>
    <p>ID: <span id="uid"></span></p>
    <p>Email: <span id="email"></span></p>
    <p>Balance: $<span id="balance">0</span></p>
    <p>Elsa: <span id="elsa">0</span></p>
    <p>Referral link: <input readonly id="refLink" onclick="copyRef()" /></p>
    <button class="btn" onclick="showVerification()">Verify</button>
    <div id="verifyMsg"></div>
    <h3>üí≥ Wallet</h3>
    <button class="btn" onclick="deposit()">Deposit</button>
    <button class="btn" onclick="showWithdraw()">Withdraw</button>
    <div id="withdrawForm" style="display:none">
      <input type="number" id="withdrawAmount" placeholder="Amount">
      <select id="withdrawType">
        <option>Opay</option>
        <option>Kuda</option>
        <option>Moniepoint</option>
        <option>FCMB</option>
        <option>Zenith</option>
      </select>
      <input type="text" id="withdrawNumber" placeholder="Wallet Number">
      <button class="btn" onclick="submitWithdraw()">Submit Withdraw</button>
    </div>
    <div id="userMsg"></div>
    <button class="btn" onclick="logout()">Logout</button>
  </div>

  <div id="leaderboardPage" class="page">
    <h2>üèÖ Leaderboard</h2>
    <div id="leaderboardList">Loading...</div>
  </div>

  <div id="supportPage" class="page">
    <h2>üì£ Support</h2>
    <p>Elsa Coin is a smart resale platform with real value.</p>
    <p>Email: eluxxes@gmail.com</p>
    <p>Withdrawals take 2 hours to reflect.</p>
  </div>

  <div id="nav">
    <button onclick="showPage('homePage')">üè†</button>
    <button onclick="showPage('userPage')">üë§</button>
    <button onclick="showPage('leaderboardPage')">üèÖ</button>
    <button onclick="showPage('supportPage')">üì£</button>
  </div>
<!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // Firebase Init
    const firebaseConfig = {
      apiKey: "AIzaSyApuMISYyAXo7Xdxa_FAYDG-tHaU5vJA6A",
      authDomain: "elsa-809c1.firebaseapp.com",
      projectId: "elsa-809c1",
      storageBucket: "elsa-809c1.firebasestorage.app",
      messagingSenderId: "401983741723",
      appId: "1:401983741723:android:253c41bf6a9011d0483dbe"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const splash = document.getElementById('splash');
    const lang = document.getElementById('languageSelect');
    const authPage = document.getElementById('authPage');
    const nav = document.getElementById('nav');

    setTimeout(() => {
      splash.style.display = "none";
      lang.style.display = "flex";
    }, 3000);

    function showAuth(language) {
      lang.style.display = "none";
      authPage.style.display = "block";
    }

    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
      document.getElementById(pageId).style.display = 'block';
    }

    function login() {
      const email = document.getElementById('authEmail').value;
      const pass = document.getElementById('authPassword').value;
      auth.signInWithEmailAndPassword(email, pass)
        .then(user => initApp(user.user))
        .catch(() => showMsg('authMessage', 'Invalid login info'));
    }

    function register() {
      const email = document.getElementById('authEmail').value;
      const pass = document.getElementById('authPassword').value;
      auth.createUserWithEmailAndPassword(email, pass)
        .then(user => {
          const uid = user.user.uid;
          db.collection('users').doc(uid).set({
            email: email,
            balance: email === "eluxxes@gmail.com" ? 2000 : 0,
            elsa: email === "eluxxes@gmail.com" ? 2000/2000 : 0,
            verified: false,
            referrals: [],
            isLord: false,
            refLink: uid
          });
          initApp(user.user);
        })
        .catch(() => showMsg('authMessage', 'Invalid registration info'));
    }

    function initApp(user) {
      document.getElementById('authPage').style.display = 'none';
      nav.style.display = 'flex';
      showPage('homePage');
      loadUser(user.uid);
    }

    function loadUser(uid) {
      db.collection('users').doc(uid).onSnapshot(doc => {
        const d = doc.data();
        document.getElementById('uid').textContent = uid;
        document.getElementById('email').textContent = d.email;
        document.getElementById('balance').textContent = d.balance.toFixed(2);
        document.getElementById('elsa').textContent = d.elsa.toFixed(3);
        document.getElementById('refLink').value = location.href + "?ref=" + uid;
      });
    }

    function copyRef() {
      const ref = document.getElementById('refLink');
      ref.select(); document.execCommand('copy');
      showMsg('userMsg', 'Referral link copied');
    }

    function buyElsa() {
      const amt = parseFloat(document.getElementById('buyAmount').value);
      if (amt < 2) return showMsg('buyMsg', 'Minimum $2');
      const uid = auth.currentUser.uid;
      db.runTransaction(async t => {
        const ref = db.collection('users').doc(uid);
        const snap = await t.get(ref);
        let data = snap.data();
        if (data.balance < amt) throw 'Insufficient funds';
        t.update(ref, {
          balance: data.balance - amt,
          elsa: data.elsa + amt / 2000
        });
      }).then(() => showMsg('buyMsg', 'Purchased Elsa')).catch(() => showMsg('buyMsg', 'Insufficient funds'));
    }

    function resellElsa() {
      const uid = auth.currentUser.uid;
      db.collection('users').doc(uid).get().then(doc => {
        const d = doc.data();
        if (!d.verified) return showMsg('buyMsg', 'Verify account to resell');
        const resellValue = d.elsa * 2000 * 0.9; // 10% admin fee
        db.collection('users').doc(uid).update({
          balance: d.balance + resellValue,
          elsa: 0
        }).then(() => showMsg('buyMsg', 'Resold successfully'));
      });
    }

    function deposit() {
      window.open("https://paystack.com/buy/lilzok-vjmgrv", "_blank");
    }

    function showWithdraw() {
      document.getElementById('withdrawForm').style.display = 'block';
    }

    function submitWithdraw() {
      const uid = auth.currentUser.uid;
      const amt = parseFloat(document.getElementById('withdrawAmount').value);
      const wallet = document.getElementById('withdrawType').value;
      const number = document.getElementById('withdrawNumber').value;

      db.collection('users').doc(uid).get().then(doc => {
        const bal = doc.data().balance;
        if (amt > bal) return showMsg('userMsg', 'Insufficient funds');
        db.collection('withdrawals').add({
          uid, amt, wallet, number, status: "pending", timestamp: Date.now()
        });
        db.collection('users').doc(uid).update({
          balance: bal - amt
        });
        showMsg('userMsg', 'Withdrawal request sent');
      });
    }

    function logout() {
      auth.signOut().then(() => location.reload());
    }

    function showMsg(id, msg) {
      const box = document.getElementById(id);
      box.innerHTML = `<div class='error'>${msg}</div>`;
      setTimeout(() => box.innerHTML = '', 2000);
    }

    // Chart Simulation
    let elsaPrice = 2000;
    setInterval(() => {
      const change = (Math.random() * 10 - 5).toFixed(2);
      elsaPrice += parseFloat(change);
      if (elsaPrice < 1000) elsaPrice = 1000;
      document.getElementById('chartArea').innerHTML = `üíπ Elsa: $${elsaPrice.toFixed(2)} <br> (Change: ${change})`;
    }, 3000);

    // Referral
    window.onload = () => {
      const url = new URL(location.href);
      const ref = url.searchParams.get('ref');
      auth.onAuthStateChanged(user => {
        if (user && ref) {
          db.collection('users').doc(ref).update({
            referrals: firebase.firestore.FieldValue.arrayUnion(user.uid)
          });
        }
      });
    };

  </script>
</body>
</html>
  
