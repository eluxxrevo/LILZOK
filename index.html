<!-- ELSA APP - SINGLE HTML FILE (FINAL VERSION) --><!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Elsa App</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #111, #222);
      color: gold;
    }
    .container {
      padding: 20px;
    }
    .page {
      display: none;
    }
    .active {
      display: block;
    }
    input, button, select {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      border-radius: 5px;
    }
    nav {
      position: fixed;
      bottom: 0;
      width: 100%;
      display: flex;
      justify-content: space-around;
      background: #000;
      color: gold;
      border-top: 1px solid gold;
    }
    nav button {
      flex: 1;
      background: transparent;
      border: none;
      color: gold;
      font-weight: bold;
    }
    .toast {
      background: red;
      color: white;
      padding: 10px;
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 5px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="toast" id="toast">Error</div>  <!-- Language Page -->  <div class="page active" id="splash">
    <div class="container">
      <h1 style="text-align:center; margin-top:40vh;">ðŸŒŸ ELSA APP ðŸŒŸ<br><small>The Supreme</small></h1>
    </div>
  </div>  <div class="page" id="language">
    <div class="container">
      <h2>Select Language</h2>
      <button onclick="showPage('auth')">English</button>
      <button onclick="showPage('auth')">FranÃ§ais</button>
    </div>
  </div>  <!-- Auth Page -->  <div class="page" id="auth">
    <div class="container">
      <h2>Login or Register</h2>
      <input type="email" id="authEmail" placeholder="Email">
      <input type="password" id="authPassword" placeholder="Password">
      <input type="text" id="referralCode" placeholder="Referral Code (Required)">
      <button onclick="register()">Register</button>
      <button onclick="login()">Login</button>
    </div>
  </div>  <!-- Home Page -->  <div class="page" id="home">
    <div class="container">
      <h2>Welcome to Elsa</h2>
      <canvas id="elsaChart" height="200"></canvas>
      <p>Current Elsa Price: <span id="elsaPrice">Loading...</span></p>
      <input type="number" id="buyAmount" placeholder="Amount in USD">
      <button onclick="buyElsa()">Buy Elsa</button>
      <input type="number" id="sellAmount" placeholder="Amount in Elsa">
      <button onclick="sellElsa()">Sell Elsa</button>
    </div>
  </div>  <!-- Wallet Page -->  <div class="page" id="wallet">
    <div class="container">
      <h2>Your Wallet</h2>
      <p>Email: <span id="userEmail"></span></p>
      <p>Balance: $<span id="userBalance"></span></p>
      <p>Elsa Owned: <span id="userElsa"></span></p>
      <button onclick="withdraw()">Withdraw</button>
      <button onclick="logout()">Logout</button>
    </div>
  </div>  <!-- Navigation -->  <nav id="mainNav" style="display:none">
    <button onclick="showPage('home')">Home</button>
    <button onclick="showPage('wallet')">Wallet</button>
  </nav>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyC8kLmGOyODdlrvHId2Nz3opdpT0tvD5mk",
      authDomain: "elsa-ab176.firebaseapp.com",
      projectId: "elsa-ab176",
    };
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const toast = (msg) => {
      const t = document.getElementById('toast');
      t.innerText = msg;
      t.style.display = 'block';
      setTimeout(() => (t.style.display = 'none'), 2000);
    };

    const showPage = (id) => {
      document.querySelectorAll('.page').forEach((p) => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    };

    setTimeout(() => showPage('language'), 4000); // Splash screen

    let currentUser = null;

    function register() {
      const email = document.getElementById('authEmail').value;
      const password = document.getElementById('authPassword').value;
      const refCode = document.getElementById('referralCode').value;
      if (!refCode) return toast("Referral code required");

      db.collection('users').where('refCode', '==', refCode).get().then(snap => {
        if (snap.empty) return toast("Invalid referral code");
        auth.createUserWithEmailAndPassword(email, password).then(cred => {
          const userData = {
            email,
            balance: 0,
            elsaOwned: 0,
            isVerified: false,
            isLord: false,
            refCode: email.split('@')[0] + Math.floor(Math.random() * 1000),
            refBy: refCode,
            referrals: 0,
          };
          db.collection('users').doc(cred.user.uid).set(userData);
          currentUser = userData;
          document.getElementById('userEmail').innerText = email;
          showPage('home');
          document.getElementById('mainNav').style.display = 'flex';
        });
      });
    }

    function login() {
      const email = document.getElementById('authEmail').value;
      const password = document.getElementById('authPassword').value;
      auth.signInWithEmailAndPassword(email, password)
        .then(cred => {
          db.collection('users').doc(cred.user.uid).get().then(doc => {
            currentUser = doc.data();
            document.getElementById('userEmail').innerText = currentUser.email;
            document.getElementById('userBalance').innerText = currentUser.balance;
            document.getElementById('userElsa').innerText = currentUser.elsaOwned;
            showPage('home');
            document.getElementById('mainNav').style.display = 'flex';
          });
        })
        .catch(() => toast("Invalid information"));
    }

    function buyElsa() {
      const amount = parseFloat(document.getElementById('buyAmount').value);
      if (isNaN(amount) || amount < 2) return toast("Minimum $2 to buy");
      // Update price and elsaOwned here (simplified)
      toast("Purchase complete");
    }

    function sellElsa() {
      const amount = parseFloat(document.getElementById('sellAmount').value);
      if (isNaN(amount)) return toast("Enter valid Elsa amount");
      // Update price and balance (simplified)
      toast("Sale complete");
    }

    function withdraw() {
      if (!currentUser || currentUser.balance < 5) return toast("Minimum $5 to withdraw");
      toast("Withdrawal requested");
    }

    function logout() {
      auth.signOut().then(() => {
        showPage('auth');
        document.getElementById('mainNav').style.display = 'none';
      });
    }
  </script></body>
</html>
